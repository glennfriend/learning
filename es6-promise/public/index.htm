<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-type' content='text/html; charset=utf-8'>
    <title>Example</title>
    <script src="assets/es6-promise/es6-promise.js"></script>
    <script src="assets/jquery/jquery.js"></script>
    <script src="assets/bootstrap/js/bootstrap.js"></script>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css" />
    <style>
        pre.display {
            background-color: #ffffff;
            border: 0px;
            display: none;
        }
    </style>
    <script>
        "use strict";


        var message = '';
        function echo(msg)
        {
            var tmp = '';
            for ( var i = 0; i < arguments.length; i++) {
                if ( '' === tmp ) {
                    tmp = arguments[i];
                }
                else {
                    tmp += ' ' + arguments[i];
                }
            }
            if ( !message ) {
                message = tmp;
            }
            else {
                message += "\n" + tmp;
            }
        }

        function output()
        {
            var output = message;
            message = '';
            return output;
        }

        function init()
        {
            // clean all pre code "\n" and space
            $(".js-return").each(function(){
                var text = $(this).text();
                $(this).text(
                    text.trim()
                );
            });

            // render
            $(".js-return").each(function(){
                var that = this;
                $(this).append('<input style="float:right" type="button" class="is_clean" value="clean" />');
                $(this).children('.is_clean').on('click', function(){
                    $(that).next('pre').text('');
                });

                $(this).append('<input style="float:right" type="button" class="is_return" value="return" />');
                $(this).children('.is_return').on('click', function(){
                    var code = $(this).parent().text();
                    var run = new Function(code);
                    run();
                    $(that).next('pre').css('display', 'block');
                    var text = $(that).next('pre').text();
                    if (text) {
                        text = text + "\n";
                    }
                    $(that).next('pre').text( text + output() );
                });
            });
        }

        $(function() {

            // load template
            $(".js-load").on('click', function(){
                var template = $(this).attr('rel');
                $('#content').load( template + ".htm", function(response, status, xhr){
                    if (status=2000) {
                        init();
                    }
                });
            });

            init();

        });
    </script>
  </head>
  <body>

    <section>
        <div class="navbar navbar-inverse navbar-static-top">
            <div class="container">
                <div class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <section style="margin:20px;">
        <div class="row">
            <div class="col-md-2">

                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title"></h3>
                    </div>
                    <div class="list-group">
                        <a href="javascript:void(0);" class="list-group-item js-load" rel="basic">Basic</a>
                        <a href="javascript:void(0);" class="list-group-item js-load" rel="get-json">Get URL</a>
                        <a href="javascript:void(0);" class="list-group-item js-load" rel="syntactic-sugar">Syntactic Sugar</a>
                        <a href="javascript:void(0);" class="list-group-item js-load" rel="flow-sample">A Flow Sample</a>
                        <a href="javascript:void(0);" class="list-group-item js-load" rel="about-chain">About Chain</a>
                        <a href="javascript:void(0);" class="list-group-item js-load" rel="thenable">Thenable</a>

                        <a href="javascript:void(0);" class="list-group-item js-load" rel="promise-all">Promise.all</a>
                        <a href="javascript:void(0);" class="list-group-item js-load" rel="promise-race">Promise.race</a>


                        <a href="javascript:void(0);" class="list-group-item js-load" rel="just-test">Just test only</a>                        
                    </div>
                </div>

            </div>
            <div id="content" class="col-md-10">

                <ul>
                    <li>使用 Promise 規範
                        <ol>
                            <li>總是使用 Promise Chain</li>
                        </ol>
                    </li>
                </ul>

                <h4>resolve 基本型</h4>
                <pre class="js-return">
var promise = new Promise(function(resolve, reject){
    resolve(200);
});

promise
.then(function(value){
    console.info(value);
})
.catch(function(error){
    console.warn(error);
});
                </pre>

                <h4>resolve 語法糖</h4>
                <pre class="js-return">
Promise.resolve(200)
.then(function(value){
    console.info(value);
})
.catch(function(error){
    console.warn(error);
});
                </pre>


        </div>
    </section>

  </body>
</html>